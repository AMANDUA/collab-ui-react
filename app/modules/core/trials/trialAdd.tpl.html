<!-- Add Trial Modal -->

<!-- header -->
<div class="modal-header">
  <button type="button" class="close" ng-click="trial.cancelModal()">
    <span class="sr-only" translate="common.close"></span>
  </button>
  <h3 class="modal-title" translate="trialModal.addTrial.title"></h3>
</div>

<!-- body -->
<div class="modal-body trials">
  <form id="addTrialForm" class="cs-form trial-modal" name="trialForm" novalidate>

    <!-- customer information -->
    <div class="cs-form__section">
      <div class="section__info">
        <h4 class="section__title" translate="partnerHomePage.customerInformation"></h4>
      </div>
      <div class="section__content">
        <formly-form model="trial.details" fields="trial.custInfoFields"></formly-form>
      </div>
    </div>

    <!-- regional settings -->
    <trial-regional-settings
      cr-feature-toggle feature-show="huron-federated-spark-call"
      filter-country-list="false"
      default-country="trial.details.country"
      default-country-list="trial.defaultCountryList"
      on-change-fn="trial.setDefaultCountry(country)">
    </trial-regional-settings>

    <trial-regional-settings
      cr-feature-toggle feature-show="huron-support-for-thinktel"
      filter-country-list="true"
      default-country="trial.details.country"
      default-country-list="trial.defaultCountryList"
      on-change-fn="trial.setDefaultCountry(country)">
    </trial-regional-settings>

    <!-- trial services -->
    <div class="cs-form__section">
      <div class="section__info">
        <h4 translate="partnerHomePage.trialServices"></h4>
            <p class="section__description" translate="trials.supportSelectLocations"></p>
      </div>
      <div class="section__content">
        <div class="sub-section">
          <h5 class="sub-section__label" translate="subscriptions.message"></h5>
          <formly-form model="trial.trialData.trials" fields="trial.messageFields"></formly-form>
        </div>

        <div class="sub-section">
          <h5 class="sub-section__label" translate="subscriptions.meeting"></h5>
          <formly-form model="trial.trialData.trials" fields="trial.meetingFields"></formly-form>
        </div>

        <div class="sub-section">
          <h5 class="sub-section__label" translate="subscriptions.call"></h5>
          <formly-form model="trial.trialData.trials" fields="trial.callFields"></formly-form>
        </div>

        <div class="sub-section" ng-if="trial.showCare">
          <h5 class="sub-section__label" translate="subscriptions.care"></h5>
          <input
                  cs-input
                  type="checkbox"
                  id="careTrial"
                  name="careTrial"
                  ng-if="trial.showBasicCare"
                  ng-model="trial.careTrial.enabled"
                  ng-disabled="trial._helpers.messageOfferDisabledExpression() "
                  cs-input-label="{{::'trials.careDescription' | translate}}"
                  cs-input-help-text="{{::'trials.careHelp' | translate}}"
          >
          <formly-form model="trial.trialData.trials" fields="trial.careFields" ng-if="trial.showBasicCare"></formly-form>
          <input
                  cs-input
                  type="checkbox"
                  id="advanceCareTrial"
                  name="advanceCareTrial"
                  ng-if="trial.showAdvanceCare"
                  ng-model="trial.advanceCareTrial.enabled"
                  ng-disabled="trial._helpers.messageOfferDisabledExpression() "
                  cs-input-label="{{::'trials.advanceCareDescription' | translate}}"
                  cs-input-help-text="{{::'trials.advanceCareHelp' | translate}}"
          >
          <formly-form model="trial.trialData.trials" fields="trial.advanceCareFields" ng-if="trial.showAdvanceCare"></formly-form>
        </div>

        <div class="sub-section" ng-if="trial.showRoomSystems">
          <h5 class="sub-section__label" translate="subscriptions.room"></h5>
          <formly-form model="trial.roomSystemTrial" fields="trial.roomSystemFields"></formly-form>
          <formly-form model="trial.sparkBoardTrial" fields="trial.sparkBoardFields" ng-if="trial.sbTrial"></formly-form>
        </div>
      </div>
    </div>

    <!-- license quantity -->
    <div class="cs-form__section">
      <div class="section__info">
        <h4 translate="trials.licenseQuantity"></h5>
      </div>
      <div class="section__content">
        <formly-form model="trial.trialData.trials" fields="trial.licenseCountFields"></formly-form>
      </div>
    </div>

    <!-- trial duration -->
    <div class="cs-form__section">
      <div class="section__info">
        <h4 translate="trials.trialDuration"></h5>
      </div>
      <div class="section__content">
        <formly-form model="trial.details" fields="trial.trialTermsFields"></formly-form>
      </div>
    </div>

    <!-- context service trial -->
    <div class="cs-form__section" ng-if="trial.showContextServiceTrial">
      <div class="section__info">
        <h4 translate="partnerHomePage.nonTrialServices"></h4>
      </div>
      <div class="section__content">
        <formly-form model="trial.trialData.trials" fields="trial.nonTrialServices"></formly-form>
      </div>
    </div>
  </form>
</div>

<!-- footer -->
<div class="modal-footer trials">
  <button id="cancelNewTrialButton" class="btn" ng-click="$dismiss()" ng-disabled="trial.loading">
    <span translate="partnerHomePage.cancel"></span>
  </button>
  <button id="startTrialButton" class="btn btn--primary" type="button" cs-btn loading="trial.loading"
    ng-click="trialForm.$setPristine(true); trial.nextStep()" ng-disabled="trialForm.$invalid || !trial.hasTrial() || !trial.uniqueName || !trial.uniqueEmail">
      <span ng-if="!trial.hasNextStep()" translate="partnerHomePage.startTrial"></span>
      <span ng-if="trial.hasNextStep()" translate="common.next"></span>
  </button>
</div>
