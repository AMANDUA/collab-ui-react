<div class="loading" ng-if="!vm.isLoaded">
  <i class="icon icon-spinner"></i>
</div>
<div class="domain-page" ng-if="vm.isLoaded">
  <div ng-if="vm.isDomainReserved">
    <p translate="firstTimeWizard.currentSubdomainDescriptionWithLink"
      translate-interpolation="messageformat"
      translate-value-count="{{vm.subdomainCount}}"
      translate-value-href="{{:: vm.sipHelpLink}}"
    ></p>
    <p ng-if="!vm.isCsc" translate="firstTimeWizard.subdomainChangesDescription"></p>
  </div>
  <p ng-if="!vm.isDomainReserved"
    translate="firstTimeWizard.subdomainDescriptionWithLink"
    translate-interpolation="messageformat"
    translate-value-count="{{vm.subdomainCount}}"
    translate-value-href="{{:: vm.sipHelpLink}}"
  ></p>

  <div ng-if="!vm.showModifyForm" class="domain--top-margin">
    <h6 translate="firstTimeWizard.reservedSubdomains"></h6>
    <div class="p domain--top-margin">
      <div>{{vm.callFQDN}}</div>
      <div ng-if="vm.isRoomLicensed">{{vm.roomFQDN}}</div>
    </div>
    <p ng-if="vm.showEditLink" class="domain--top-margin">
      <a href
        id="editSubdomainLink"
        translate="firstTimeWizard.editSubdomain"
        ng-click="vm.editSubdomain()"
      ></a>
    </p>
  </div>

  <div ng-if="vm.showModifyForm"
    ng-form
    name="vm.form"
    novalidate
    role="form"
    class="domain--top-margin"
  >
    <label for="sipDomainInput"
      translate="firstTimeWizard.enterSubdomain"
    ></label>
    <div class="domain--flex">
      <div class="domain-input-group"
        ng-class="{info: vm.isDomainAvailable, error: vm.form.sipDomainInput.$invalid && vm.form.sipDomainInput.$touched}"
      >
        <input
          class="domain-input"
          type="text"
          id="sipDomainInput"
          name="sipDomainInput"
          ng-change="vm.resetDomainAvailability()"
          ng-required="true"
          ng-maxlength="40"
          ng-model="vm.subdomain"
        >
        <div class="cs-input__messages"
          ng-messages="vm.form.sipDomainInput.$error"
          role="alert"
        >
          <div ng-repeat="(msgKey, msgValue) in vm.messages"
            class="message"
            ng-message="{{msgKey}}"
          >{{msgValue}}</div>
          <div class="message" ng-if="vm.isDomainAvailable">
            <div>{{::'common.available' | translate}}:</div>
            <div>{{vm.callFQDN}}</div>
            <div ng-if="vm.isRoomLicensed">{{vm.roomFQDN}}</div>
          </div>
        </div>
      </div>
      <div class="domain-buttons">
        <button cs-btn
          type="button"
          class="btn btn--cta domain-button"
          loading="vm.isSubdomainLoading"
          ng-click="vm.verifyAvailabilityAndValidity()"
          ng-disabled="vm.isEmptyOrUnchangedInput || vm.isSaving"
        >
          <span translate="firstTimeWizard.setSipDomainCheckAvailability"></span>
        </button>
        <button type="button"
          class="btn"
          translate="common.cancel"
          ng-click="vm.cancel()"
          ng-disabled="vm.isSaving"
        ></button>
      </div>
    </div>
  </div>
</div>
