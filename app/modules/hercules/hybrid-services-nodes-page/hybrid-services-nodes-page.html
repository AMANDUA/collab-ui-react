<div ng-if="$ctrl.loading" class="text-center spinner-container">
  <i class="icon icon-spinner icon-2x"></i>
</div>

<div class="none_found" ng-if="!$ctrl.loading && $ctrl.data.nodes.length === 0">
  <i class="icon icon-circle-data"></i>
  <span class="h2" translate="hercules.nodesPage.noNodes"></span>
</div>

<div ng-if="!$ctrl.loading && $ctrl.data.nodes.length > 0">
  <connector-upgrade-banner nodes="$ctrl.data.nodes" cluster="$ctrl.clusterCache" on-modal-closed="$ctrl.reloadDataCallback(options)"></connector-upgrade-banner>
  <table>
    <thead>
      <tr>
        <th scope="col" translate="hercules.nodesPage.connectors"></th>
        <th scope="col" translate="hercules.nodesPage.status"></th>
        <th scope="col" translate="hercules.nodesPage.version"></th>
      </tr>
    </thead>
    <tbody ng-repeat="node in $ctrl.data.nodes | orderBy:'name' track by node.serial">
      <tr class="hostname">
        <td colspan="4">
          <span class="nodename">{{::node.name}}</span>
          <div class="pull-right">
            <span ng-if="node.platformVersion !== 'unknown'" class="node-serial" translate="hercules.nodesPage.platformVersion" translate-value-version="{{::node.platformVersion}}"></span>
            <span class="node-serial" translate="hercules.nodesPage.serial" translate-value-serial="{{::node.serial}}"></span>
            <hybrid-services-nodes-page-actions
              cluster-id="$ctrl.data.id"
              cluster-name="$ctrl.data.name"
              node="node"
              number-of-cluster-nodes="$ctrl.data.nodes.length"
              target-type="$ctrl.data.targetType"
              reload-data-callback="$ctrl.reloadDataCallback(options)">
            </hybrid-services-nodes-page-actions>
          </div>
        </td>
      </tr>
      <tr class="connector-row" ng-repeat="connector in node.connectors | orderBy:'connectorType':false:$ctrl.hybridConnectorsComparator" ng-click="$ctrl.openSidepanel(connector)" ng-class="{'active': $ctrl.isSidepanelOpen(connector)}">
        <td>{{::connector.service}}</td>
        <td>
          <span ng-hide="connector.maintenanceMode === 'on' || (connector.maintenanceMode === 'pending' && connector.extendedProperties.state.name !== 'offline')">
            <cs-statusindicator ng-model="connector.extendedProperties.state.cssClass"></cs-statusindicator>
            <span class="status">{{::'hercules.status.'+connector.extendedProperties.state.name | translate}}</span>
            <span class="badge badge--outline {{connector.extendedProperties.alarmsBadgeCss}}"
              ng-if="connector.extendedProperties.alarms !== 'none'"
              translate="hercules.alarms.alarms">
            </span>
          </span>
          <span class="badge badge--outline"
            ng-show="connector.maintenanceMode === 'on' && connector.extendedProperties.state.name !== 'offline'"
            translate="hercules.nodesPage.maintenanceReady">
          </span>
          <span class="badge badge--outline"
            ng-show="connector.maintenanceMode === 'on' && connector.extendedProperties.state.name === 'offline'"
            translate="hercules.nodesPage.maintenanceOn">
          </span>
          <span class="badge badge--outline"
            ng-show="connector.maintenanceMode === 'pending'"
            translate="hercules.nodesPage.maintenancePending"
            tooltip="{{::node.pendingTooltip}}"
            tooltip-trigger="mouseenter focus"
            tooltip-placement="top"
            aria-label="{{::node.pendingTooltip}}"
            tabindex="0">
          </span>
        </td>
        <td>
          {{::connector.version}}
          <span class="badge badge--outline info" ng-if="connector.hasUpgradeAvailable" translate="hercules.fusion.list.upgrade"></span>
          <span class="badge badge--outline info" ng-if="connector.upgradesAutomatically" translate="hercules.fusion.list.upgradesAutomatically"></span>
          <span ng-hide="connector.maintenanceMode === 'on' && connector.connectorType === 'mf_mgmt'">
            <span class="badge badge--outline info" ng-if="connector.upgradeState === 'upgrading'" translate="hercules.fusion.list.upgrading"></span>
          </span>
          <span class="badge badge--outline info" ng-if="connector.upgradeState === 'pending'" translate="hercules.fusion.list.pending"></span>
        </td>
      </tr>
      <tr class="connector-row-filler" ng-if="!$last">
        <td colspan="3"></td>
      </tr>
    </tbody>
  </table>
</div>
