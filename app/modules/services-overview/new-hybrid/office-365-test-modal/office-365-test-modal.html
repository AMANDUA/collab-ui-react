<div class="modal-header">
  <button type="button" class="close" ng-click="$ctrl.dismiss()">
    <span class="sr-only" translate="common.close"></span>
  </button>
  <h1 class="modal-title">Hybrid Calendar setup</h1>
</div>
<div class="modal-body" ng-if="!$ctrl.success">
  <h2>Test Account</h2>
  <div ng-form="$ctrl.emailTestingForm" novalidate>
    <div class="row">
      <div class="cs-input-group medium-12 columns">
        <input
          cs-input
          ng-focus="true"
          type="email"
          name="email"
          cs-input-group-size="medium-10"
          cs-input-label="Enter the Office 365 account you want to use to test the connection with Exchange Online."
          cs-input-messages="$ctrl.validationMessages"
          ng-keypress="$ctrl.handleKeypress($event)"
          ng-required="true"
          ng-model="$ctrl.email">
      </div>
    </div>
  </div>
</div>
<div class="modal-body" ng-if="$ctrl.success">
  <h2>Setup complete</h2>
  <p>You're ready to enable the Hybrid Calendar Service for your Office 365 users:</p>
  <ul>
    <li>Individually from the <a ng-click="$ctrl.goToUsers()">users page</a>.</li>
    <li>In bulk using the <a  ng-click="$ctrl.manageUsers()">CSV template</a>.</li>
  </ul>
  <p>For more information, go to <a href="http://collaborationhelp.cisco.com" target="_blank">Collaboration Help</a>.</p>
</div>
<div class="modal-footer" ng-if="!$ctrl.success">
  <button cs-btn class="btn btn-default" ng-click="$ctrl.dismiss()">
    <span>Cancel</span>
  </button>
  <button cs-btn class="btn btn-primary" ng-disabled="!$ctrl.emailTestingForm.$valid" loading="$ctrl.loading" ng-click="$ctrl.test($ctrl.email)">
    <span>Test</span>
  </button>
</div>
<div class="modal-footer" ng-if="$ctrl.success">
  <button cs-btn class="btn btn-primary" ng-click="$ctrl.close()">
    <span translate="common.done"></span>
  </button>
</div>
