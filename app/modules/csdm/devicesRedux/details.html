<div class="details-pane">

  <h2 style="display: flex; align-items: center">
    <i
      class="icon icon-2x icon-circle-unlock"
      ng-if="deviceDetails.device.type != 'group' && deviceDetails.device.needsActivation"
    />
    <i
      class="icon icon-2x icon-circle-telepresence"
      ng-if="deviceDetails.device.type != 'group' && !deviceDetails.device.needsActivation"
    />
    <i
      class="icon icon-2x icon-circle-group"
      ng-if="deviceDetails.device.type == 'group'"
    />

    <div
      class="ellipsis"
      style="flex-grow: 2"
      ng-bind-html="deviceDetails.device.displayName | highlight:devices.searchObject">
    </div>
    <a href ui-sref="devices-redux.search">
      <i
        class="icon icon-back"
      />
    </a>
  </h2>

  <div ng-switch on="deviceDetails.device.type">
    <div ng-switch-when="group">

      <!-- room -->

      <strong style="padding-bottom: 20px; display: block">
        DEVICES IN ROOM
      </strong>
      <ul class="small-block-grid-1 medium-block-grid-2 large-block-grid-3">
        <li
          ng-click="devices.expandDevice(device)"
          ng-repeat="device in deviceDetails.device.devices">
          <div ng-include="'modules/csdm/devicesRedux/deviceCard.html'"></div>
        </li>
      </ul>

    </div>
    <div ng-switch-default>

      <!-- device / code -->

      <strong
        ng-bind-html="deviceDetails.device.product | highlight:devices.searchObject">
      </strong>

      <div class="para" style="display: flex; align-items: center">
        <img
          ng-if="deviceDetails.device.image"
          ng-src="{{deviceDetails.device.image}}"
          style="width: 220px; padding-right: 10px"
        />
        <div>
          <div>
            <i
              style="padding-right: 10px"
              class="fa fa-circle device-status"
              ng-class="deviceDetails.device.cssColorClass"
            />
            <span ng-bind-html="deviceDetails.device.state.readableState | highlight:devices.searchObject"></span>
          </div>
          <div class="tag-container" style="display: flex; align-items: center; flex-wrap: wrap;">
            <span
              class="tag"
              ng-repeat="tag in deviceDetails.device.tags">
              <span ng-bind-html="tag | highlight:devices.searchObject"/>
              <i
                class="fa fa-times"
                ng-click="deviceDetails.tags.removeTag(deviceDetails.device, tag)"
              />
            </span>
            <a href
               ng-hide="deviceDetails.tags.isAdding"
               ng-click="deviceDetails.tags.isAdding = !deviceDetails.tags.isAdding">
              Add tag
            </a>
            <input
              type="text"
              placeholder="Enter tag..."
              ng-model="deviceDetails.tags.newTag"
              ng-show="deviceDetails.tags.isAdding"
              focus-on="deviceDetails.tags.isAdding"
              ng-blur="deviceDetails.tags.isAdding = false"
              ng-keyup="deviceDetails.tags.createTag(deviceDetails.device, $event)"
            />
          </div>
        </div>
      </div>

      <div ng-show="deviceDetails.device.hasIssues" class="device-issues">
        <strong>Issues</strong>
        <div class="para">
          <div ng-repeat="event in deviceDetails.device.diagnosticsEvents">
            <p>
              <i class="fa fa-circle device-status-red"/>
              <span ng-bind-html="event.type | highlight:devices.searchObject"/>
            </p>
            <p>{{event.message}}</p>
          </div>
        </div>
      </div>

      <strong>
        Details
      </strong>

      <div class="para" ng-if="deviceDetails.device.needsActivation">
        <div class="row" ng-if="deviceDetails.device.expiryTime">
          <div class="small-4 columns">Expiry Time:</div>
          <div class="small-8 columns ellipsis" ng-bind-html="deviceDetails.device.expiryTime | date : 'medium'"></div>
        </div>
      </div>


      <div class="para" ng-if="!deviceDetails.device.needsActivation">
        <div class="row" ng-show="deviceDetails.device[key]" ng-repeat="(key, name) in deviceDetails.deviceProps">
          <div class="small-4 columns">{{name}}:</div>
          <div class="small-8 columns ellipsis"
               ng-bind-html="deviceDetails.device[key] | highlight:devices.searchObject"></div>
        </div>
      </div>

      <div class="button-bar">
        <a href
           ng-if="!deviceDetails.device.needsActivation"
           sq-click-promise="deviceDetails.reportProblem()">
          Report Problem
        </a>

        <a href
           ng-click="deviceDetails.deleteDevice()">
          {{deviceDetails.device.needsActivation ? 'Delete activation code...' : 'Delete device...'}}
        </a>
      </div>

    </div>
  </div>

</div>
