<!-- BEGIN CI Sync -->
<div ng-if="!sync.authorized()">
  <span class="icon icon-warning"></span>
  <span translate="messengerCiSync.errorUnauthorizedToView"></span>
</div>

<div class="container-ci-sync" ng-if="sync.authorized()">

  <cs-page-header title-name="{{:: 'messengerCiSync.pageTitle' | translate }}" back="true" back-url="sync.backState"></cs-page-header>

  <div class="content">
    <!-- BEGIN CONTENT -->

    <div ng-if="sync.dataStates.LOADING === sync.dataStatus">
      <span class="icon icon-spinner"></span>
      <span translate="messengerCiSync.loading"></span>
    </div>

    <div ng-if="sync.dataStates.ERROR === sync.dataStatus">
      <span class="icon icon-warning"></span>
      <span>{{sync.errorMsg}}</span>
      <p class="down-10">
        <span ng-click="sync.refreshStatus()" class="right-5">
          <i class="icon icon-refresh"></i> {{sync.refresh}}
        </span>
      </p>
    </div>

    <div ng-if="sync.dataStates.LOADED === sync.dataStatus">
      <div class="right">
        <span ng-click="sync.refreshStatus()" class="right-5">
          <i class="icon icon-refresh"></i> {{sync.refresh}}
        </span>
        |
        <span><a tooltip-placement="left" tooltip="{{sync.orgAdminLinkTooltip}}" href="{{sync.orgAdminUrl}}" target="_blank" translate="messengerCiSync.orgAdminLinkText"></a></span>
      </div>

      <div class="col-md-4 sync-stats">
          <h3 translate="messengerCiSync.syncStatusHeading"></h3>

          <input cs-input type="text"
            id="ciSyncOrgSettingsOrgName"
            name="ciSyncOrgSettingsOrgName"
            ng-model="sync.syncInfo.messengerOrgName"
            cs-input-label="{{:: 'messengerCiSync.labelOrgName' | translate }}"
            cs-input-group-size="medium-12"
            disabled
            read-only>
          <input cs-input type="text"
            id="ciSyncOrgSettingsOrgId"
            name="ciSyncOrgSettingsOrgId"
            ng-model="sync.syncInfo.messengerOrgId"
            cs-input-label="{{:: 'messengerCiSync.labelOrgId' | translate }}"
            cs-input-group-size="medium-12"
            disabled
            read-only>
          <input cs-input type="text"
            id="ciSyncOrgSettingsCiLinkDate"
            name="ciSyncOrgSettingsCiLinkDate"
            ng-model="sync.syncInfo.linkDate"
            cs-input-label="{{:: 'messengerCiSync.labelCILinkDate' | translate }}"
            cs-input-group-size="medium-12"
            disabled
            read-only>

          <div ng-if="sync.syncInfo.isMessengerSyncRawMode"> <!-- Native Messenger Sync mode -->
            <p tooltip-placement="top" tooltip="{{sync.syncStatusTooltip}}" translate="messengerCiSync.syncStatusHeading"></p>
            <!-- Ugly, but it seems the only way that works so far. Would be nice to find simpler way -->
            <cs-toggle-switch ng-if="sync.isOpsAdmin()" ng-model="sync.syncInfo.isSyncEnabled" toggle-id="toggleIsSyncing" name="toggleSyncing" size="small"></cs-toggle-switch>
            <!-- text when not editable -->
            <div ng-if="!sync.isOpsAdmin()">
              <boolean-text-field value="sync.syncInfo.isSyncEnabled"></boolean-text-field>
            </div>
          </div>
          <div ng-if="!sync.syncInfo.isMessengerSyncRawMode"> <!-- Native CI DirSync mode -->
            <p tooltip-placement="top" tooltip="{{sync.dirsyncStatusTooltip}}" translate="messengerCiSync.dirsyncStatusHeading"></p>
            <!-- text when not editable -->
            <boolean-text-field value="sync.syncInfo.isSyncEnabled"></boolean-text-field>
          </div>

          <p tooltip-placement="bottom" tooltip="{{sync.authRedirectTooltip}}" translate="messengerCiSync.authRedirectHeading"></p>
          <!-- Ugly, but it seems the only way that works so far. Would be nice to find simpler way -->
          <cs-toggle-switch ng-if="sync.isOpsAdmin()" ng-model="sync.syncInfo.isAuthRedirect" toggle-id="toggleAuthRedirect" name="toggleAuth" size="small"></cs-toggle-switch>
          <!-- text when not editable -->
          <div ng-if="!sync.isOpsAdmin()">
            <boolean-text-field value="sync.syncInfo.isAuthRedirect"></boolean-text-field>
          </div>

          <div ng-if="sync.syncInfo.isNewDataFormat"> <!-- new org ext data -->
            <!-- using toggles when editable -->
            <div ng-if="sync.isOpsAdmin()">
              <p tooltip-placement="top" tooltip="{{sync.pwdSyncTooltip}}" translate="messengerCiSync.pwdSyncHeading"></p>
              <cs-toggle-switch ng-model="sync.syncInfo.isPwdSync" toggle-id="tidPwdSync" name="tnPwdSync" size="small"></cs-toggle-switch>
              <p tooltip-placement="top" tooltip="{{sync.sparkEntTooltip}}" translate="messengerCiSync.sparkEntHeading"></p>
              <cs-toggle-switch ng-model="sync.syncInfo.isSparkEnt" toggle-id="tidSparkEnt" name="tnSparkEnt" size="small"></cs-toggle-switch>
              <p tooltip-placement="top" tooltip="{{sync.usrDisTooltip}}" translate="messengerCiSync.usrDisHeading"></p>
              <cs-toggle-switch ng-model="sync.syncInfo.isUsrDis" toggle-id="tidUsrDis" name="tnUsrDis" size="small"></cs-toggle-switch>
              <p tooltip-placement="top" tooltip="{{sync.usrDelTooltip}}" translate="messengerCiSync.usrDelHeading"></p>
              <cs-toggle-switch ng-model="sync.syncInfo.isUsrDel" toggle-id="tidUsrDel" name="tnUsrDel" size="small"></cs-toggle-switch>
            </div>
            <!-- text when not editable -->
            <div ng-if="!sync.isOpsAdmin()">
              <p tooltip-placement="top" tooltip="{{sync.pwdSyncTooltip}}" translate="messengerCiSync.pwdSyncHeading"></p>
              <boolean-text-field value="sync.syncInfo.isPwdSync"></boolean-text-field>

              <p tooltip-placement="top" tooltip="{{sync.sparkEntTooltip}}" translate="messengerCiSync.sparkEntHeading"></p>
              <boolean-text-field value="sync.syncInfo.isSparkEnt"></boolean-text-field>

              <p tooltip-placement="top" tooltip="{{sync.usrDisTooltip}}" translate="messengerCiSync.usrDisHeading"></p>
              <boolean-text-field value="sync.syncInfo.isUsrDis"></boolean-text-field>

              <p tooltip-placement="top" tooltip="{{sync.usrDelTooltip}}" translate="messengerCiSync.usrDelHeading"></p>
              <boolean-text-field value="sync.syncInfo.isUsrDel"></boolean-text-field>
            </div>
          </div>

          <input class="btn btn--attention" type="submit" value="{{sync.patchSyncButtonText}}" ng-if="sync.isOpsAdmin()" ng-click="sync.patchSync()">
      </div>
    </div>

    <!-- END CONTENT -->
  </div>

</div>
<!-- END CI Sync -->
